# 闪念式APK编译指南

## 自动编译方法

### 方法一：使用批处理文件（推荐）

1. 双击运行 `build-apk.bat`
2. 按照提示安装必要的工具（如果需要）
3. 等待编译完成

### 方法二：使用Android Studio

1. 下载并安装 [Android Studio](https://developer.android.com/studio)
2. 打开Android Studio，选择"Open an existing project"
3. 选择"闪念式"文件夹
4. 等待项目同步完成
5. 点击菜单：Build > Build Bundle(s) / APK(s) > Build APK(s)
6. APK将生成在 `app/build/outputs/apk/debug/` 目录

## 手动编译步骤

### 1. 环境准备

#### 安装Java JDK
- 下载 [OpenJDK 11或更高版本](https://jdk.java.net/11/)
- 安装后设置环境变量：
  ```
  JAVA_HOME=C:\Program Files\Java\jdk-11
  Path=%JAVA_HOME%\bin;%PATH%
  ```

#### 安装Android SDK
- 安装Android Studio时会自动安装SDK
- 确保安装了以下组件：
  - Android SDK Platform-Tools
  - Android SDK Build-Tools
  - Android 14 (API 34)

### 2. 编译命令

打开命令提示符，进入项目目录：

```bash
cd E:\codex\闪念式

# 清理项目
gradlew clean

# 构建Debug APK
gradlew assembleDebug

# 构建Release APK（需要签名）
gradlew assembleRelease
```

### 3. 签名Release APK（可选）

创建 `app/keystore.properties` 文件：

```properties
storeFile=../my-release-key.keystore
keyAlias=alias_name
keyPassword=your_key_password
storePassword=your_store_password
```

运行签名命令：
```bash
gradlew assembleRelease
```

## 常见问题

### 问题1：找不到gradlew
**解决方案**：确保项目目录包含 `gradlew` 文件，否则：
```bash
# 下载gradlew
curl -L -o gradlew https://github.com/gradle/gradle/raw/master/gradle/wrapper/gradlew

# 设置执行权限（Windows可能需要）
gradlew.bat
```

### 问题2：Android SDK找不到
**解决方案**：
1. 打开Android Studio
2. Tools > SDK Manager
3. 确保已安装Android 14 (API 34)
4. 记录SDK路径，设置环境变量：
   ```
   ANDROID_SDK_ROOT=C:\Android\Sdk
   ```

### 问题3：网络问题
**解决方案**：
1. 配置gradle镜像（在 `build.gradle` 中添加）：
   ```gradle
   repositories {
       maven { url 'https://maven.aliyun.com/repository/google' }
       maven { url 'https://maven.aliyun.com/repository/central' }
       google()
       mavenCentral()
   }
   ```

### 问题4：编译失败
**解决方案**：
1. 检查Java版本：`java -version`
2. 检查Android版本兼容性
3. 查看详细错误日志
4. 清理项目重新编译：`gradlew clean`

## APK文件位置

### Debug APK（无需签名）
```
app/build/outputs/apk/debug/app-debug.apk
```

### Release APK（需要签名）
```
app/build/outputs/apk/release/app-release.apk
```

## 安装APK

### 使用adb安装
```bash
# 连接设备
adb devices

# 安装APK
adb install app/build/outputs/apk/debug/app-debug.apk
```

### 直接传输
1. 将APK文件复制到手机
2. 在手机上找到APK文件并点击安装
3. 如果提示"未知来源"，在设置中开启

## 开发建议

### 使用Android模拟器
1. 在Android Studio中创建AVD
2. 选择合适的系统镜像（推荐API 34）
3. 启动模拟器后运行应用

### 真机调试
1. 开启开发者选项和USB调试
2. 连接手机
3. 授权电脑调试

## 技术支持

如果遇到编译问题，可以：
1. 查看控制台错误信息
2. 检查项目依赖是否完整
3. 确保所有配置文件正确
4. 查看官方文档：https://developer.android.com/studio

祝编译顺利！